(()=>{"use strict";var t=function(){function t(){this.images={body:new Image,hour:new Image,minute:new Image,second:new Image},this.rotations={body:0,hour:0,minute:0,second:0},this.baseHour=0,this.baseRotations=0,this.width=0,this.height=0,this.velocity=0,this.isResetting=!1}return t.prototype.load=function(t){return e=this,n=void 0,r=function(){var e,n,o,r,i,s,a;return function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(c){switch(c.label){case 0:for(o in n=[],e=t)n.push(o);r=0,c.label=1;case 1:return r<n.length?(o=n[r])in e?(i=o,s=this.images,a=i,[4,(l=t[i],new Promise((function(t,e){var n=new Image;n.onload=function(){return t(n)},n.onerror=function(){return e()},n.src=l})))]):[3,3]:[3,4];case 2:s[a]=c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return[2]}var l}))},new((o=void 0)||(o=Promise))((function(t,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(s,a)}c((r=r.apply(e,n||[])).next())}));var e,n,o,r},t.prototype.computeSizesFromCanvas=function(t){var e=this.images.body,n=Math.min(t.width/e.width,t.height/e.height);this.width=e.width*n,this.height=e.height*n},t.prototype.resetRotation=function(){this.isResetting=!0,this.baseRotations=Math.abs(this.rotations.second)},t.prototype.applyRotation=function(e,n){this.velocity=e*(n?1:1/t.DEGREES_PER_SECOND)},t.prototype.update=function(){var e=this.rotations;if(this.isResetting)for(var n=0;n<this.baseRotations*t.RESET_ROTATION_RATE;){if(e.second-=Math.sign(e.second),0===e.second){this.isResetting=!1;break}++n}this.isResetting||(e.second+=Math.floor(t.DEGREES_PER_SECOND*this.velocity)),e.minute=Math.floor(e.second/t.DEGREES_PER_SECOND/60)*t.DEGREES_PER_MINUTE,e.hour=e.minute/t.DEGREES_PER_MINUTE/60*t.DEGREES_PER_HOUR,e.second%=60*t.DEGREES_PER_SECOND*60*12,this.velocity=Math.floor(.001*this.velocity)},t.prototype.render=function(t){var e=this.width,n=this.height,o=t.canvas;for(var r in t.clearRect(0,0,o.width,o.height),this.images){var i=this.images[r],s=this.rotations[r];t.save(),t.translate(o.width/2,o.height/2),t.rotate(s*Math.PI/180),t.drawImage(i,0,0,i.width,i.height,-e/2,-n/2,e,n),t.restore()}},t.DEGREES_PER_SECOND=6,t.DEGREES_PER_MINUTE=6,t.DEGREES_PER_HOUR=30,t.RESET_ROTATION_RATE=.01,t}();const e=t;function n(t){var e=t.getBoundingClientRect();return e.bottom>0&&e.right>0&&e.left<(window.innerWidth||document.documentElement.clientWidth)&&e.top+100<(window.innerHeight||document.documentElement.clientHeight)}var o=function(){function t(t,e){this.children=[],this.anchorIndex=-1,this.originalAnchorIndex=-1,this.children=Array.from(t.querySelectorAll(e));for(var o=0;o<this.children.length;++o)if(n(this.children[o])){this.anchorIndex=o;break}this.originalAnchorIndex=this.anchorIndex}return t.prototype.reset=function(){this.anchorIndex=this.originalAnchorIndex},t.prototype.onViewportChange=function(t){var e=this;return function(){var o=-1,r=e.children[e.anchorIndex];if(t(n(r),r),e.anchorIndex-1>0){var i=e.anchorIndex-1,s=e.children[i],a=n(s);t(a,s);for(var c=0;c<i;++c)t(!1,e.children[c]);a&&(o=i)}if(e.anchorIndex+1<e.children.length){i=e.anchorIndex+1;var l=e.children[i],u=n(l);for(t(u,l),c=i+1;c<e.children.length;++c)t(!1,e.children[c]);u&&(o=i)}o>-1&&(e.anchorIndex=o)}},t}(),r=document.querySelector("#root"),i=document.querySelector("#scrollable"),s=document.querySelector("#centerpoint"),a=document.querySelector("canvas"),c=a.getContext("2d"),l=new e,u=0,h={previous:null,current:null,pressed:!1},d=null,f=Date.now(),p=f;function v(t,e){return Math.atan2(t,e)/Math.PI*180}function w(){window.requestAnimationFrame(w);var t=(f=Date.now())-p,e=1e3/120;t>e&&(p=f-t%e,function(){if(h.pressed&&(h.previous=h.current,h.current=d),h.pressed&&h.previous&&h.current&&!l.isResetting){var t=a.getBoundingClientRect(),e=(t.left+t.right)/2,n=(t.top+t.bottom)/2,o=h.previous.x-e,r=v(h.previous.y-n,o),s=h.current.x-e,c=v(h.current.y-n,s),f=Math.floor(c-r);Math.abs(f)<180&&(i.scrollTop+=f,l.applyRotation(f),Math.abs(i.scrollTop-u)>=20&&(window.dispatchEvent(new CustomEvent("customscroll")),u=i.scrollTop))}l.update()}(),l.render(c))}function E(){h.previous=null,h.current=null,h.pressed=!1,d=null}window.addEventListener("mousedown",(function(){h.pressed=!0})),window.addEventListener("mouseup",(function(){E(),l.applyRotation(0)})),window.addEventListener("mousemove",(function(t){d={x:t.clientX,y:t.clientY}})),window.addEventListener("touchstart",(function(){h.pressed=!0}),{passive:!1}),window.addEventListener("touchend",(function(){E(),l.applyRotation(0)})),window.addEventListener("touchmove",(function(t){t.preventDefault(),d={x:t.touches[0].clientX,y:t.touches[0].clientY}}),{passive:!1}),i.addEventListener("wheel",(function(t){t.preventDefault()}),{passive:!1}),window.addEventListener("load",(function(){return t=this,e=void 0,c=function(){var t,e;return function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(n){switch(n.label){case 0:return r.classList.remove("hidden"),i.querySelector("#centerpoint").scrollIntoView({behavior:"instant",block:"center",inline:"center"}),t=new o(i,"[data-scroll-class]"),e=t.onViewportChange((function(t,e){var n,o,r=e.dataset.scrollClass.split(" ");if(t)return e.classList.remove("hidden"),void(n=e.classList).add.apply(n,r);e.classList.add("hidden"),(o=e.classList).remove.apply(o,r)})),window.addEventListener("customscroll",e,!1),dispatchEvent(new CustomEvent("customscroll")),document.querySelectorAll("a.smooth-scroll").forEach((function(e){e.addEventListener("click",(function(n){var o;n.preventDefault();var r=e.getAttribute("href"),i=document.querySelector(e.getAttribute("href"));i.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.focus({preventScroll:!0}),t.reset(),s.classList.remove("hidden"),(o=s.classList).add.apply(o,s.dataset.scrollClass.split(" ")),"#centerpoint"===r&&l.resetRotation()}))})),[4,l.load({body:"/assets/watch/body.png",hour:"/assets/watch/hour.png",minute:"/assets/watch/minute.png",second:"/assets/watch/second.png"})];case 1:return n.sent(),a.width*=window.devicePixelRatio,a.height*=window.devicePixelRatio,l.computeSizesFromCanvas(a),w(),[2]}}))},new((n=void 0)||(n=Promise))((function(o,r){function i(t){try{a(c.next(t))}catch(t){r(t)}}function s(t){try{a(c.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}a((c=c.apply(t,e||[])).next())}));var t,e,n,c}))})();